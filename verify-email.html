<!DOCTYPE html>
<html lang="pt-br">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6241000006441036"
     crossorigin="anonymous"></script>


  <meta charset="UTF-8" />
  <title>Verificando e-mail... | Mooose</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Verifique seu e-mail para ativar sua conta na Mooose, plataforma de correção de redação do ENEM com IA.">
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap"
    rel="stylesheet"
  />
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HRHF1XJTSD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-HRHF1XJTSD');
  </script>

  <style>
    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: "Montserrat", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #dbeafe, #eff6ff 40%, #e2e8f0 100%);
      margin: 0;
      padding: 1rem;
    }
    main {
      background: white;
      border-radius: 24px;
      padding: 2.5rem 2rem;
      max-width: 460px;
      width: 100%;
      box-shadow: 0 20px 50px rgba(15, 23, 42, 0.18);
      text-align: center;
      border: 2px solid #e2e8f0;
    }
    .logo-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
      margin-bottom: 1.5rem;
    }
    .logo-row {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    .mooose-logo {
      width: 48px;
      height: 48px;
    }
    .logo-word {
      font-weight: 900;
      letter-spacing: 0.18em;
      font-size: 1.1rem;
      /* sem color aqui pra não sobrescrever .logo-m / .logo-o /.logo-rest */
    }
    .logo-subtitle {
      font-size: 0.75rem;
      color: #64748b;
    }
    .badge-edu {
      padding: 0.1rem 0.5rem;
      border-radius: 99px;
      border: 1px solid #cbd5e1;
      background: #f8fafc;
      font-size: 0.7rem;
      color: #64748b;
      margin-left: 0.5rem;
      vertical-align: middle;
    }
    h2 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: #1f2933;
    }
    p {
      font-size: 0.95rem;
      color: #64748b;
      margin-bottom: 1.5rem;
    }
    a {
      color: #2563eb;
      font-weight: 600;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    #verification-message {
      font-size: 1.1rem;
      margin-top: 1rem;
      margin-bottom: 1.5rem;
      color: var(--text-muted);
    }
    #verification-message.success {
      color: var(--success);
    }
    #verification-message.error {
      color: var(--danger);
    }
  </style>
</head>
<body>
  <main>
    <div class="logo-area" style="align-items: center; margin-bottom: 1.5rem;">
      <div class="logo-row">
        <img src="logo.png" alt="Mooose" class="mooose-logo" />
        <span class="logo-word">
          <span class="logo-m">M</span>
          <span class="logo-o logo-o-1">O</span>
          <span class="logo-o logo-o-2">O</span>
          <span class="logo-o logo-o-3">O</span>
          <span class="logo-rest">SE</span>
        </span>
      </div>
      <span class="logo-subtitle">
        Correção de redações do ENEM com IA <span class="badge-edu">2 créditos grátis</span>
      </span>
    </div>

    <h2>Verificando seu e-mail...</h2>
    <p id="verification-message">Aguarde um momento.</p>
    <a href="index.html">Voltar para a Mooose</a>
  </main>

  <script src="app.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const msgEl = document.getElementById("verification-message");

      const params = new URLSearchParams(window.location.search);
      const token = params.get("token");

      if (!token) {
        msgEl.textContent = "Erro: Token de verificação não encontrado na URL.";
        msgEl.classList.add("error");
        return;
      }

      // API_BASE vem do app.js
      if (typeof API_BASE === 'undefined') {
        msgEl.textContent = "Erro: Falha ao carregar configuração da API.";
        msgEl.classList.add("error");
        return;
      }

      try {
        const res = await fetch(`${API_BASE}/auth/verify-email?token=${encodeURIComponent(token)}`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            }
        });

        const data = await res.json();

        if (!res.ok) {
            throw new Error(data.detail || "Falha ao verificar o token.");
        }

        msgEl.textContent = data.message || "E-mail verificado com sucesso!";
        msgEl.classList.add("success");

      } catch (err) {
        console.error(err);
        msgEl.textContent = `Erro: ${err.message}`;
        msgEl.classList.add("error");
      }
    });
  </script>
</body>
</html>
